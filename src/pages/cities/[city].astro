---
import BaseLayout from '../../layouts/BaseLayout.astro';
import LeadForm from '../../components/LeadForm.astro';
import { cities } from '../../data/cities';
import { getStateBySlug } from '../../data/states';

export function getStaticPaths() {
  return cities.map(city => ({
    params: { city: city.slug },
    props: { city }
  }));
}

const { city } = Astro.props;
const state = getStateBySlug(city.stateSlug);

// Build SEO title - keep under 37 chars so with suffix stays under 60
const fullCityTitle = `${city.name} Hit and Run Accident Lawyers`;
const seoTitle = fullCityTitle.length <= 37 ? fullCityTitle : `${city.name} Hit and Run Lawyers`;

const schema = {
  "@context": "https://schema.org",
  "@type": "LegalService",
  "name": `${city.name} Hit and Run Accident Lawyers`,
  "description": `Find experienced hit and run accident lawyers in ${city.name}, ${city.stateAbbr}. Free case evaluation.`,
  "areaServed": {
    "@type": "City",
    "name": city.name,
    "containedInPlace": {
      "@type": "State",
      "name": city.state
    }
  }
};
---

<BaseLayout 
  title={seoTitle}
  description={`Find experienced hit and run accident lawyers in ${city.name}, ${city.stateAbbr}. ${state?.statOfLimitations} statute of limitations. Free case evaluation.`}
  schema={schema}
>
  <!-- Hero -->
  <section class="bg-primary text-white py-12">
    <div class="max-w-7xl mx-auto px-4">
      <nav class="text-sm text-gray-400 mb-4">
        <a href="/" class="hover:text-white">Home</a> ‚Üí 
        <a href="/cities/" class="hover:text-white">Cities</a> ‚Üí 
        <a href={`/states/${city.stateSlug}/`} class="hover:text-white">{city.state}</a> ‚Üí 
        <span class="text-white">{city.name}</span>
      </nav>
      <h1 class="text-4xl md:text-5xl font-bold mb-4">{city.name} Hit and Run Accident Lawyers</h1>
      <p class="text-xl text-gray-300">Experienced hit and run accident attorneys in {city.name}, {city.stateAbbr}</p>
    </div>
  </section>

  <div class="max-w-7xl mx-auto px-4 py-12">
    <div class="grid lg:grid-cols-3 gap-12">
      <!-- Main Content -->
      <div class="lg:col-span-2">
        <!-- Urgent Warnings -->
        {state?.statOfLimitations === "1 year" && (
          <div class="bg-red-100 border-l-4 border-red-500 p-4 mb-8 rounded-r-lg">
            <h2 class="font-bold text-red-800 text-lg">‚ö†Ô∏è URGENT: 1-Year Deadline in {city.state}</h2>
            <p class="text-red-700">Your state has only a 1-year statute of limitations. Contact an attorney immediately.</p>
          </div>
        )}

        {state?.faultSystem.includes("Contributory") && (
          <div class="bg-orange-100 border-l-4 border-orange-500 p-4 mb-8 rounded-r-lg">
            <h2 class="font-bold text-orange-800 text-lg">‚ö†Ô∏è Contributory Negligence State</h2>
            <p class="text-orange-700">{city.state} follows contributory negligence rules. An experienced attorney is critical for your claim.</p>
          </div>
        )}

        <!-- City Overview -->
        <div class="bg-white p-6 rounded-xl shadow mb-8">
          <h2 class="text-2xl font-bold mb-4">Hit and Run Accidents in {city.name}</h2>
          <p class="text-gray-600 mb-4">
            With a population of {city.population.toLocaleString()}, {city.name} sees a significant number of hit and run accidents each year. 
            Urban density, busy intersections, and high traffic volume contribute to both accidents and drivers fleeing the scene.
            If you've been the victim of a hit and run in {city.name}, you may be entitled to compensation.
          </p>

          <div class="grid md:grid-cols-2 gap-4 mt-6">
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="font-semibold text-gray-700">Population</h3>
              <p class="text-2xl font-bold">{city.population.toLocaleString()}</p>
            </div>
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="font-semibold text-gray-700">State</h3>
              <p class="text-2xl font-bold">{city.stateAbbr}</p>
            </div>
          </div>
        </div>

        <!-- High Risk Areas -->
        {city.dangerousIntersections && city.dangerousIntersections.length > 0 && (
          <div class="bg-white p-6 rounded-xl shadow mb-8">
            <h2 class="text-2xl font-bold mb-4">High-Risk Accident Areas in {city.name}</h2>
            <p class="text-gray-600 mb-4">Areas with frequent traffic accidents and hit and run incidents:</p>
            <ul class="space-y-2">
              {city.dangerousIntersections.map(intersection => (
                <li class="flex items-center gap-2">
                  <span class="text-red-500">‚ö†Ô∏è</span>
                  <span>{intersection}</span>
                </li>
              ))}
            </ul>
          </div>
        )}

        <!-- What to Do After Hit and Run -->
        <div class="bg-white p-6 rounded-xl shadow mb-8">
          <h2 class="text-2xl font-bold mb-4">Hit and Run in {city.name}? Take These Steps</h2>
          <ol class="space-y-4">
            <li class="flex items-start gap-3">
              <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 font-bold">1</span>
              <div>
                <h3 class="font-bold">Stay at the Scene & Call 911</h3>
                <p class="text-gray-600 text-sm">Never chase the fleeing driver. Report to {city.name} police immediately.</p>
              </div>
            </li>
            <li class="flex items-start gap-3">
              <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 font-bold">2</span>
              <div>
                <h3 class="font-bold">Document Everything</h3>
                <p class="text-gray-600 text-sm">Vehicle description, direction of travel, partial plate numbers, debris.</p>
              </div>
            </li>
            <li class="flex items-start gap-3">
              <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 font-bold">3</span>
              <div>
                <h3 class="font-bold">Check for Surveillance Cameras</h3>
                <p class="text-gray-600 text-sm">Nearby businesses may have captured the accident.</p>
              </div>
            </li>
            <li class="flex items-start gap-3">
              <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 font-bold">4</span>
              <div>
                <h3 class="font-bold">Seek Medical Attention</h3>
                <p class="text-gray-600 text-sm">Even minor injuries should be documented. Symptoms often appear later.</p>
              </div>
            </li>
            <li class="flex items-start gap-3">
              <span class="bg-primary text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 font-bold">5</span>
              <div>
                <h3 class="font-bold">Contact a Hit and Run Attorney</h3>
                <p class="text-gray-600 text-sm">We can help investigate, file claims, and pursue compensation.</p>
              </div>
            </li>
          </ol>
        </div>

        <!-- Local Considerations -->
        <div class="bg-gray-50 p-6 rounded-xl mb-8">
          <h2 class="text-2xl font-bold mb-4">Local Resources in {city.name}</h2>
          <ul class="space-y-3">
            <li class="flex items-start gap-3">
              <span class="text-primary text-xl">‚Üí</span>
              <span><strong>{city.name} Police Department:</strong> File a hit and run report with local police</span>
            </li>
            <li class="flex items-start gap-3">
              <span class="text-primary text-xl">‚Üí</span>
              <span><strong>Traffic Cameras:</strong> {city.name} may have intersection cameras that captured your accident</span>
            </li>
            <li class="flex items-start gap-3">
              <span class="text-primary text-xl">‚Üí</span>
              <span><strong>Crime Stoppers:</strong> Anonymous tips may help identify the fleeing driver</span>
            </li>
          </ul>
        </div>

        <!-- State Laws Reference -->
        {state && (
          <div class="bg-white p-6 rounded-xl shadow">
            <h2 class="text-2xl font-bold mb-4">{city.state} Hit and Run Laws</h2>
            <div class="grid md:grid-cols-2 gap-4">
              <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="font-semibold text-gray-700">Statute of Limitations</h3>
                <p class="text-lg font-bold text-primary">{state.statOfLimitations}</p>
              </div>
              <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="font-semibold text-gray-700">Fault System</h3>
                <p class="text-lg font-bold">{state.faultSystem}</p>
              </div>
            </div>
            <div class="mt-4">
              <a href={`/states/${city.stateSlug}/`} class="text-primary hover:underline font-medium">
                View all {city.state} hit and run laws ‚Üí
              </a>
            </div>
          </div>
        )}
      </div>

      <!-- Sidebar -->
      <div class="lg:col-span-1">
        <div class="sticky top-24">
          <LeadForm 
            source={`city-${city.slug}`} 
            title={`Free ${city.name} Case Review`}
            subtitle={`Speak with an attorney who handles ${city.name} hit and run accidents.`}
          />
          
          <div class="mt-8 bg-primary text-white p-6 rounded-xl">
            <h3 class="font-bold text-lg mb-2">üöó Time Is Critical</h3>
            <p class="text-gray-300 text-sm">Surveillance footage gets deleted. Witnesses forget. Evidence disappears. Contact us now to protect your case.</p>
            <a href="/free-consultation/" class="mt-4 inline-block bg-white text-primary px-4 py-2 rounded font-bold hover:bg-gray-100 transition">Get Free Review</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>
